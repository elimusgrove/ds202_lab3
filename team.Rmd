---
title: "team"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggmosaic)
library(readxl)
gss = readxl::read_xls('./data.xls')
```

## Data Setup

```{r}
names(gss) = c('year', 'understanding', 'happiness', 'political_party', 'region', 'total_income', 'race', 'sex', 'num_children', 'spouse_hours_work_week', 'marital_status', 'respondent_id', 'ballot_used')
```

### 1.

##### Marital status seems to have a small effect on happiness. Looking at the married category, the total number of people who are 'very happy' is higher than any other marriage category. Married people are also the lowest in the 'not too happy' category than any other happiness level. The other marriage categories are roughly equal for all other happiness levels. Couples are happier when they are together 
##### Variables Used: marital_status, happiness
```{r}
gss$marital_status = factor(gss$marital_status, levels=c('No answer', 'Never married', 'Divorced', 'Separated', 'Widowed', 'Married', 'NA'))
ggplot(gss, aes(x=marital_status, fill=happiness)) + geom_bar(position='fill')
```

### 2.

##### There isn't a difference between men and women in the happiness levels at each marriage category. However, something interesting is that there were far more female windowed responders in the data.
```{r}
ggplot(gss, aes(x=marital_status, fill=happiness)) + geom_bar() + facet_wrap(~sex) + coord_flip()
```

```{r}
# ggplot(gss, aes(x=marital_status, fill=happiness)) + geom_bar(position='fill') + facet_grid(marital_status ~ sex) + coord_flip()
```

### 3.

##### In general, self-identified republicans seem to be happier than self-identified democrats. There seems to be a general trend that the stronger the political identify one has the happier they are in relation to those of the same party at a weaker identification level. Those that aren't involved in politics were either very happy or very unhappy. Those that didn't answer political association also at high rates didn't enter their happiness level.
```{r}
gss$political_party = factor(gss$political_party, levels=c('Strong republican', 'Not str republican', 'Ind,near rep', 'Independent', 'Ind,near dem', 'Not str democrat', 'Strong democrat', 'Other party', 'No answer', 'Don\'t know'))
ggplot(gss, aes(x=political_party, fill=happiness)) + geom_bar(position='fill') +  coord_flip()
```


### 4.

##### 4.1 How has happiness levels changed over time between men and women?
```{r}

```

##### 4.2 How have the number of children people have changed over time?


##### 4.3 How does the number of children affect happiness levels?


##### 4.4 How does race affect total income?
Race seems to be correlated with income. About 25% of black participants answered that their income was $10000 or less while about half that amount answered for white and other participants.
```{r}
gss$total_income[gss$total_income %in% c('Lt $1000', '$1000 to 2999', '$3000 to 3999', '$4000 to 4999')] = '$0 - 4999'
gss$total_income[gss$total_income %in% c('$5000 to 5999', '$6000 to 6999', '$7000 to 7999', '$8000 to 9999')] = '$5000 - 9999'
gss$total_income = gss$total_income[!(gss$total_income == 'Don\'t know'), ]

gss$total_income = factor(gss$total_income, levels=c('$0 - 4999', '$5000 - 9999', '$10000 - 14999', '$15000 - 19999', '$20000 - 24999', '$25000 or more', 'Don\'t know', 'Refused', 'No answer', 'Not applicable'))

levels(gss$total_income)
ggplot(gss, aes(x=race, fill=total_income)) + geom_bar(position='fill')
```
