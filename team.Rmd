---
title: "team"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggmosaic)
library(readxl)
gss = readxl::read_xls('./data.xls')
```

## Data Setup

```{r}
names(gss) = c('year', 'understanding', 'happiness', 'political_party', 'region', 'total_income', 'race', 'sex', 'num_children', 'spouse_hours_work_week', 'marital_status', 'respondent_id', 'ballot_used')
```

### 1.

##### Marital status seems to have a small effect on happiness. Looking at the married category, the total number of people who are 'very happy' is higher than any other marriage category. Married people are also the lowest in the 'not too happy' category than any other happiness level. The other marriage categories are roughly equal for all other happiness levels. Couples are happier when they are together 
##### Variables Used: marital_status, happiness
```{r}
gss$marital_status = factor(gss$marital_status, levels=c('No answer', 'Never married', 'Divorced', 'Separated', 'Widowed', 'Married', 'NA'))
ggplot(gss, aes(x=marital_status, fill=happiness)) + geom_bar(position='fill')
```

### 2.

##### There isn't a difference between men and women in the happiness levels at each marriage category. However, something interesting is that there were far more female windowed responders in the data.
```{r}
ggplot(gss, aes(x=marital_status, fill=happiness)) + geom_bar() + facet_wrap(~sex) + coord_flip()
```

```{r}
# ggplot(gss, aes(x=marital_status, fill=happiness)) + geom_bar(position='fill') + facet_grid(marital_status ~ sex) + coord_flip()
```

### 3.

##### In general, self-identified republicans seem to be happier than self-identified democrats. There seems to be a general trend that the stronger the political identify one has the happier they are in relation to those of the same party at a weaker identification level. Those that aren't involved in politics were either very happy or very unhappy. Those that didn't answer political association also at high rates didn't enter their happiness level.
```{r}
gss$political_party = factor(gss$political_party, levels=c('Strong republican', 'Not str republican', 'Ind,near rep', 'Independent', 'Ind,near dem', 'Not str democrat', 'Strong democrat', 'Other party', 'No answer', 'Don\'t know'))
ggplot(gss, aes(x=political_party, fill=happiness)) + geom_bar(position='fill') +  coord_flip()
```


### 4.

1. Does understanding the question correlate with a person's happiness? Is ignorance truly bliss? Which political party is unable to understand a question?

First question is to see if happiness correlates with understanding

```{r}
gss$understanding = factor(gss$understanding, levels=c('No answer', "Don't know", 'Poor', 'Fair', 'Good', 'NA'))
ggplot(gss, aes(x=understanding, fill=happiness)) + geom_bar(position='fill')

```

#### According to this bar plot, it can be seen that the general understanding of the question seems to only effect happiness at the very extremes, the people that did not understand the question (answered 'Don't know') and the people that truly understood the question seem to have a higher concentration of happiness than any of the other answers. BUT you can also see that there is a suspiciously high number of 'not applicable' answers for people that didn't understand the question, which might have skewed the results some.

Now to see if this has anything to do with political party, lets take a look.

```{r}
ggplot(gss, aes(x=political_party, fill=understanding)) + geom_bar(position='fill') + coord_flip()
```

#### It would appear that if you didn't understand the question from the above  bar chart, then you probably don't have a political affiliation, or did not asnwer the survey as the top two rows have the highest focus of 'Poor'  or 'No answer' selections.

2. 
3. 
4. 
